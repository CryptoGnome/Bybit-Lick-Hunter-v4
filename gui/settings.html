<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lick-Hunter Bot</title>
    <link rel="stylesheet" href="/css/web.css" />
    <link rel="icon" type="image/x-icon" href="/img/icon.ico" />
  </head>
  <body>
    <div class="hamburger" onclick="toggleMenu()">
      <span></span>
      <span></span>
      <span></span>
    </div>

    <div class="menu" id="menu">
      <ul>
        <li><a href="/">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-activity" viewBox="0 0 16 16"> <path fill-rule="evenodd" d="M6 2a.5.5 0 0 1 .47.33L10 12.036l1.53-4.208A.5.5 0 0 1 12 7.5h3.5a.5.5 0 0 1 0 1h-3.15l-1.88 5.17a.5.5 0 0 1-.94 0L6 3.964 4.47 8.171A.5.5 0 0 1 4 8.5H.5a.5.5 0 0 1 0-1h3.15l1.88-5.17A.5.5 0 0 1 6 2Z"/> </svg>
          Dashboard
        </a></li>
        <li class="active"><a href="/settings">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="active" viewBox="0 0 16 16"> <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/> <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/> </svg>
          Settings
        </a></li>
        <li><a href="/stats">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bar-chart" viewBox="0 0 16 16"> <path d="M4 11H2v3h2v-3zm5-4H7v7h2V7zm5-5v12h-2V2h2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-2zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3z"/> </svg>
          Statistics
        </a></li>
      </ul>
    </div>

    <div class="mid">
      <header>
        <a class="logo" href="/"></a>
        <p id="message"></p>
      </header>
      <div>
        <div class="settingsfield">
          <br />
          <h2>Account Settings</h2>
          <br /><br />
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">API KEY</label>
            </div>
            <div class="input-field right">
              <input type="password" id="textbox" name="API_KEY" />
            </div>
          </div>
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">API SECRET</label>
            </div>
            <div class="input-field right">
              <input type="password" id="textbox" name="API_SECRET" />
            </div>
          </div>
          <div class="settingsValue">
            <p class="left">USE WITHDRAW</p>
            <div class="switch-container right">
              <input
                type="checkbox"
                id="switch1"
                class="switch"
                name="WITHDRAW"
              />
              <label for="switch1" class="label"></label>
            </div>
          </div>
          <br /><br />
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">WITHDRAW ADDRESS</label>
            </div>
            <div class="input-field right">
              <input type="textbox" id="textbox" name="WITHDRAW_ADDRESS" />
            </div>
          </div>
          <div class="discord-form-container">
            <label for="listbox" class="discord-form-label"
              >WITHDRAW ACCOUNT</label
            >
            <div class="right">
              <select
                id="listbox"
                name="WITHDRAW_ACCOUNT"
                class="discord-form-listbox"
              >
                <option value="SPOT">SPOT</option>
                <option value="CONTRACT">CONTRACT</option>
                <option value="FUND">FUND</option>
              </select>
            </div>
          </div>
          <br />
          <div class="discord-form-container">
            <label for="listbox" class="discord-form-label"
              >WITHDRAW COIN</label
            >
            <div class="right">
              <select
                id="listbox"
                name="WITHDRAW_COIN"
                class="discord-form-listbox">
                <option value="USDT">USDT</option>
              </select>
            </div>
          </div>
          <br />
          <div class="discord-form-container">
            <label for="listbox" class="discord-form-label">WITHDRAW CHAIN</label>
            <div class="right">
              <select
                id="listbox"
                name="WITHDRAW_CHAIN"
                class="discord-form-listbox">
                <option value="SOL">SOL</option>
                <option value="ERC20">ERC20</option>
                <option value="TRC20">TRC20</option>
                <option value="BSC">BSC (BEP20)</option>
                <option value="AVAXC">AVAXC</option>
                <option value="MATIC">MATIC</option>
                <option value="Optimism">Optimism</option>
              </select>
            </div>
          </div>
          <br />
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">AMOUNT TO WITHDRAW</label>
            </div>
            <div class="input-field right">
              <input
                type="number"
                id="numberbox"
                class="form-control"
                name="AMOUNT_TO_WITHDRAW"/>
            </div>
          </div>
          <div class="settingsValue">
            <p class="left">USE TRANSFER TO SPOT</p>
            <div class="switch-container right">
              <input
                type="checkbox"
                id="switch2"
                class="switch"
                name="TRANSFER_TO_SPOT"/>
              <label for="switch2" class="label"></label>
            </div>
          </div>
          <br /><br />
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">AMOUNT TO SPOT</label>
            </div>
            <div class="input-field right">
              <input
                type="number"
                id="numberbox"
                class="form-control"
                name="AMOUNT_TO_SPOT"/>
            </div>
          </div>
        </div>
        <br />
        <div class="settingsfield">
          <br />
          <h2>Position Settings</h2>
          <br /><br />
          <div class="discord-form-container">
            <label for="listbox" class="discord-form-label">MARGIN</label>
            <div class="right">
              <select id="listbox" name="MARGIN" class="discord-form-listbox">
                <option value="ISOLATED">ISOLATED</option>
                <option value="CROSS">CROSS</option>
              </select>
            </div>
          </div>
          <br />
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">LEVERAGE</label>
            </div>
            <div class="input-field right">
              <input
                type="number"
                id="numberbox"
                class="form-control"
                name="LEVERAGE"/>
            </div>
          </div>
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">PERCENT ORDER SIZE</label>
            </div>
            <div class="input-field right">
              <input
                type="number"
                id="numberbox"
                class="form-control"
                name="PERCENT_ORDER_SIZE"/>
            </div>
          </div>
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">MAX POSITION SIZE PERCENT</label>
            </div>
            <div class="input-field right">
              <input
                type="number"
                id="numberbox"
                class="form-control"
                name="MAX_POSITION_SIZE_PERCENT"/>
            </div>
          </div>
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">MAX OPEN POSITIONS</label>
            </div>
            <div class="input-field right">
              <input
                type="number"
                id="numberbox"
                class="form-control"
                name="MAX_OPEN_POSITIONS"/>
            </div>
          </div>
          <div class="settingsValue">
            <p class="left">USE TAKEPROFIT</p>
            <div class="switch-container right">
              <input
                type="checkbox"
                id="switch03"
                class="switch"
                name="USE_TAKE_PROFIT"/>
              <label for="switch03" class="label"></label>
            </div>
          </div>
          <br><br>
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">TAKE PROFIT PERCENT</label>
            </div>
            <div class="input-field right">
              <input
                type="number"
                id="numberbox"
                class="form-control"
                name="TAKE_PROFIT_PERCENT"/>
            </div>
          </div>
          <div class="settingsValue">
            <p class="left">USE STOPLOSS</p>
            <div class="switch-container right">
              <input
                type="checkbox"
                id="switch02"
                class="switch"
                name="USE_STOPLOSS"/>
              <label for="switch02" class="label"></label>
            </div>
          </div>
          <br /><br />
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">STOP LOSS PERCENT</label>
            </div>
            <div class="input-field right">
              <input
                type="number"
                id="numberbox"
                class="form-control"
                name="STOP_LOSS_PERCENT"/>
            </div>
          </div>
          <div class="settingsValue">
            <p class="left">USE STOP LOSS TIMEOUT</p>
            <div class="switch-container right">
              <input
                type="checkbox"
                id="switch4"
                class="switch"
                name="USE_STOP_LOSS_TIMEOUT"/>
              <label for="switch4" class="label"></label>
            </div>
          </div>
          <br /><br />
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">STOP LOSS TIMEOUT</label>
            </div>
            <div class="input-field right">
              <input
                type="number"
                id="numberbox"
                class="form-control"
                name="STOP_LOSS_TIMEOUT"/>
            </div>
          </div>
          <div class="settingsValue">
            <p class="left">USE DCA FEATURE</p>
            <div class="switch-container right">
              <input
                type="checkbox"
                id="switch5"
                class="switch"
                name="USE_DCA_FEATURE"/>
              <label for="switch5" class="label"></label>
            </div>
          </div>
          <br /><br />
          <div class="settingsValue">
            <p class="left">BIG DRAWDOWN PROTECTION</p>
            <div class="switch-container right">
              <input
                type="checkbox"
                id="switch08"
                class="switch"
                name="TIMEOUT_BLACKLIST_FOR_BIG_DRAWDOWN"/>
              <label for="switch08" class="label"></label>
            </div>
          </div>
          <br /><br />
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">DRAWDOWN THRESHOLD</label>
            </div>
            <div class="input-field right">
              <input
                type="number"
                id="numberbox"
                step="0.1"
                class="form-control"
                name="DRAWDOWN_THRESHOLD"/>
            </div>
          </div>
          <div class="settingsValue">
            <p class="left">UPDATE MIN ORDER SIZING</p>
            <div class="switch-container right">
              <input
                type="checkbox"
                id="switch7"
                class="switch"
                name="UPDATE_MIN_ORDER_SIZING"/>
              <label for="switch7" class="label"></label>
            </div>
          </div>
          <br /><br />
        </div>
        <br />
        <div class="settingsfield">
          <br />
          <h2>Liquidation Settings</h2>
          <br /><br />
          <div class="discord-form-container">
            <label for="listbox" class="discord-form-label">LIQ SOURCE</label>
            <div class="right">
              <select id="listbox" name="LIQ_SOURCE" class="discord-form-listbox">
                <option value="BYBIT">BYBIT</option>
                <option value="BINANCE">BINANCE</option>
                <option value="BOTH">BOTH</option>
              </select>
            </div>
          </div>
          <br>
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">MIN LIQUIDATION VOLUME</label>
            </div>
            <div class="input-field right">
              <input
                type="number"
                id="numberbox"
                class="form-control"
                name="MIN_LIQUIDATION_VOLUME"/>
            </div>
          </div>
          <div class="settingsValue">
            <p class="left">USE SMART SETTINGS</p>
            <div class="switch-container right">
              <input
                type="checkbox"
                id="switch6"
                class="switch"
                name="USE_SMART_SETTINGS"/>
              <label for="switch6" class="label"></label>
            </div>
          </div>
		  <br /><br />
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">RISK LEVEL LONG</label>
            </div>
            <div class="input-field right">
              <input
                type="number"
                id="numberbox"
                class="form-control"
                name="RISK_LEVEL_LONG"/>
            </div>
          </div>
		  
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">RISK LEVEL SHORT</label>
            </div>
            <div class="input-field right">
              <input
                type="number"
                id="numberbox"
                class="form-control"
                name="RISK_LEVEL_SHORT"/>
            </div>
          </div>
        </div>
        <br />
        <div class="settingsfield">
          <br />
          <h2>Coin Settings</h2>
          <br /><br />
          <div class="settingsValue">
            <p class="left">USE WHITELIST</p>
            <div class="switch-container right">
              <input
                type="checkbox"
                id="switch8"
                class="switch"
                name="USE_WHITELIST"/>
              <label for="switch8" class="label"></label>
            </div>
          </div>
          <br /><br />
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">WHITELIST</label>
            </div>
            <div class="input-field right">
              <input type="textbox" id="textbox" name="WHITELIST" />
            </div>
          </div>
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">BLACKLIST</label>
            </div>
            <div class="input-field right">
              <input type="textbox" id="textbox" name="BLACKLIST" />
            </div>
          </div>
          <br />
        </div>

        <br />
        <div class="settingsfield">
          <br />
          <h2>Misc Settings</h2>
          <br /><br />
          <div class="settingsValue">
            <p class="left">USE LOG</p>
            <div class="switch-container right">
              <input
                type="checkbox"
                id="switch9"
                class="switch"
                name="USE_LOG"/>
              <label for="switch9" class="label"></label>
            </div>
          </div>
          <br /><br />
          <div class="settingsValue">
            <p class="left">USE DISCORD</p>
            <div class="switch-container right">
              <input
                type="checkbox"
                id="switch10"
                class="switch"
                name="USE_DISCORD"/>
              <label for="switch10" class="label"></label>
            </div>
          </div>
          <br /><br />
          <div class="settingsValue">
            <p class="left">CHECK FOR UPDATE</p>
            <div class="switch-container right">
              <input
                type="checkbox"
                id="switch11"
                class="switch"
                name="CHECK_FOR_UPDATE"/>
              <label for="switch11" class="label"></label>
            </div>
          </div>
          <br /><br />
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">DISCORD URL</label>
            </div>
            <div class="input-field right">
              <input type="textbox" id="textbox" name="DISCORD_URL" />
            </div>
          </div>
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">DISCORD REPORT INTERVALL</label>
            </div>
            <div class="input-field right">
              <input
                type="textbox"
                id="textbox"
                name="DISCORD_REPORT_INTERVALL"/>
            </div>
          </div>
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">GUI PASSWORD</label>
            </div>
            <div class="input-field right">
              <input
                type="password"
                id="textbox"
                name="GUI_PASSWORD"/>
            </div>
          </div>
          <div class="input-container">
            <div class="input-label">
              <label for="textbox">GUI SESSION PASSWORD</label>
            </div>
            <div class="input-field right">
              <input
                type="password"
                id="textbox"
                name="GUI_SESSION_PASSWORD"/>
            </div>
          </div>
        </div>
      </div>
      <br /><br />
      <div class="footer" id="footer"></div>
    </div>
    <script type="text/javascript" src="/node_modules/socket.io.js"></script>
    <script>

    const socket = io();

    socket.on('connect', (socket) => {
      console.log('WebSocket-Connection OK!');
      delay(1000).then(() => getSettings());
    });

    socket.on('listening', (socket) => {
        socket.volatile.emit("sendsettings", {})
    });
    
    function delay(time) {
      return new Promise(resolve => setTimeout(resolve, time));
    }

    socket.on("settings", (msg) => {
      console.log(msg)
      for (const key in msg) {
        const value = msg[key];
        const element = document.querySelector(`input[name="${key}"]`);
        if (element) {
          if (element.type === "checkbox") {
            if (value == "true")
              element.checked = true;
            else
              element.checked = false;
          } else {
            element.value = value;
          }
        }
      }
    });

    async function getSettings(){
      socket.volatile.emit("sendsettings", {})
    }

    function toggleMenu() {
      var menu = document.getElementById("menu");
      menu.classList.toggle("active");

      var hamburger = document.getElementsByClassName("hamburger")[0];
      hamburger.classList.toggle("active");
    }

    // get all switch changes
    document.querySelectorAll(".switch").forEach((switchButton) => {
      switchButton.addEventListener("change", (event) => {
        var switchName = event.target.getAttribute("name");
        console.log("Switch change: " + switchName)
        if (event.target.checked == true) {
          socket.emit("setting", { set: switchName, val: true })
        } else {
          socket.emit("setting", { set: switchName, val: false })
        }
      });
    });

    // get all numeric changes
    document.querySelectorAll("#numberbox").forEach((switchButton) => {
      switchButton.addEventListener("change", (event) => {
        var switchName = event.target.getAttribute("name");
        socket.emit("setting", { set: switchName, val: event.target.value })
      });
    });

    // get all select changes
    document.querySelectorAll("#listbox").forEach((switchButton) => {
      switchButton.addEventListener("change", (event) => {
        var switchName = event.target.getAttribute("name");
        socket.emit("setting", { set: switchName, val: event.target.value })
      });
    });

    // get all text changes
    document.querySelectorAll("#textbox").forEach((switchButton) => {
      switchButton.addEventListener("change", (event) => {
        var switchName = event.target.getAttribute("name");
        socket.emit("setting", { set: switchName, val: event.target.value })
      });
    });

    </script>
  </body>
</html>
